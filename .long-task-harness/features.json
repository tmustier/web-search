{
  "version": "2.0",
  "description": "Feature checklist with history tracking for session continuity",
  "metadata": {
    "project_name": "web-search",
    "created": "2026-01-06",
    "last_updated": "2026-01-13",
    "total_features": 12,
    "completed_features": 12
  },
  "features": [
    {
      "id": "docs-001",
      "name": "Spec and research baseline",
      "description": "Spec-first docs capture intended behaviours, policies, and provider model",
      "steps": [
        "`docs/spec.md` documents CLI surface + policy modes",
        "`docs/research.md` captures references and risk areas",
        "`README.md` links to spec and research"
      ],
      "passes": true,
      "notes": "",
      "history": {
        "sessions": [
          {
            "session": 1,
            "date": "2026-01-06",
            "action": "completed",
            "summary": "Wrote spec/research and documented defaults (policy, caching, provider precedence)"
          },
          {
            "session": 2,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Refined CLI contract (plain/no-input), clarified failure modes, and gated remote provider auto-selection"
          },
          {
            "session": 7,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Polished public-facing docs (README/spec/research) and added CONTRIBUTING/SECURITY files for OSS readiness"
          },
          {
            "session": 10,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Selected MIT license and added `LICENSE` + updated README"
          }
        ],
        "files": ["README.md", "docs/spec.md", "docs/research.md", "LICENSE"],
        "decisions": [
          {
            "session": 1,
            "decision": "Fail-fast default with explicit `--policy` (standard/strict/permissive)"
          },
          {
            "session": 1,
            "decision": "Cache raw responses; default TTL 7d (configurable)"
          },
          {
            "session": 1,
            "decision": "Integrate Firecrawl via endpoint provider only (avoid vendoring AGPL code)"
          }
        ]
      }
    },
    {
      "id": "harness-001",
      "name": "Long-task-harness initialized",
      "description": "Project has continuity tracking configured via .long-task-harness/",
      "steps": [
        "`.long-task-harness/` exists in repo",
        "`long-task-progress.md` reflects this project (not generic template)",
        "`features.json` contains real project features (not examples)",
        "`AGENTS.md` tells agents how to invoke the harness",
        "Optional: `.claude/settings.json` installs Claude Code hooks for reminders"
      ],
      "passes": true,
      "notes": "",
      "history": {
        "sessions": [
          {
            "session": 1,
            "date": "2026-01-06",
            "action": "completed",
            "summary": "Initialized harness, tailored progress/features, and added agent-facing reminders"
          },
          {
            "session": 2,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Updated feature roadmap and progress log after spec refinements"
          }
        ],
        "files": [
          "AGENTS.md",
          ".claude/settings.json",
          ".long-task-harness/long-task-progress.md",
          ".long-task-harness/features.json",
          ".long-task-harness/init.sh"
        ],
        "decisions": []
      }
    },
    {
      "id": "py-setup-001",
      "name": "Python reference implementation scaffold",
      "description": "Project has a runnable Python package + tooling (uv/ruff/pyright/pytest)",
      "steps": [
        "`pyproject.toml` defines package + tooling configuration",
        "Ruff + Pyright configured and running cleanly",
        "Pytest runs with at least a smoke test",
        "CLI entry point exists (even if stubbed)"
      ],
      "passes": true,
      "notes": "",
      "history": {
        "sessions": [
          {
            "session": 3,
            "date": "2026-01-06",
            "action": "completed",
            "summary": "Added pyproject/uv lock, implemented wstk package, and verified ruff/pyright/pytest"
          }
        ],
        "files": ["pyproject.toml", "pyrightconfig.json", "uv.lock", "src/wstk/*", "tests/*"],
        "decisions": []
      }
    },
    {
      "id": "cli-001",
      "name": "CLI skeleton",
      "description": "CLI supports the basic user journey and flags, with clear error modes",
      "steps": [
        "`wstk search <query>` returns results (even with stub providers)",
        "`wstk fetch <url>` fetches a page and reports status",
        "`wstk extract <url|file>` outputs readable content",
        "Flags include `--policy`, `--provider`, `--cache`, `--timeout`, `--json`, `--plain`",
        "Output respects `NO_COLOR` and supports `--no-color`",
        "Non-interactive mode supports `--no-input`"
      ],
      "passes": true,
      "notes": "",
      "history": {
        "sessions": [
          {
            "session": 3,
            "date": "2026-01-06",
            "action": "completed",
            "summary": "Implemented providers/search/fetch/extract commands with JSON envelope and plain output modes"
          },
          {
            "session": 8,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Refactored CLI into small command modules for readability while keeping the CLI contract stable"
          },
          {
            "session": 9,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Centralized output-mode selection and URL policy gating, and extracted eval runner for reuse"
          }
        ],
        "files": [
          "src/wstk/cli.py",
          "src/wstk/cli_support.py",
          "src/wstk/commands/*",
          "tests/test_cli_contract.py",
          "tests/test_cli_eval_contract.py"
        ],
        "decisions": [
          {
            "session": 3,
            "decision": "Implement CLI with argparse to keep runtime dependencies minimal"
          }
        ]
      }
    },
    {
      "id": "providers-001",
      "name": "Provider interfaces + baseline search provider",
      "description": "Provider abstractions exist and at least one keyless search provider works",
      "steps": [
        "SearchProvider interface with consistent output schema",
        "At least one keyless provider implemented and documented",
        "Optional key-based providers supported (Brave API, etc.)",
        "Provider selection supports `auto` ordering (prefer configured reliability)",
        "Remote providers with higher privacy surface area are gated (policy/config) and emit clear metadata/warnings"
      ],
      "passes": true,
      "notes": "Added privacy warnings for remote search providers.",
      "history": {
        "sessions": [
          {
            "session": 3,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Added SearchProvider interface and implemented ddgs + brave_api providers with auto selection"
          },
          {
            "session": 12,
            "date": "2026-01-12",
            "action": "completed",
            "summary": "Added provider privacy warnings metadata to search, eval, and providers outputs"
          }
        ],
        "files": [
          "docs/spec.md",
          "src/wstk/commands/eval_cmd.py",
          "src/wstk/commands/providers_cmd.py",
          "src/wstk/commands/search_cmd.py",
          "src/wstk/search/registry.py"
        ],
        "decisions": []
      }
    },
    {
      "id": "fetch-001",
      "name": "Fetch pipeline + caching",
      "description": "HTTP fetcher handles redirects, content types, and caching with clear failure modes",
      "steps": [
        "HTTP fetch supports redirects and content-type detection",
        "Raw caching implemented with TTL + size bounds",
        "Blocked/403 cases fail fast by default with actionable diagnostics",
        "Optional escalation paths documented (browser profile, anti-bot)"
      ],
      "passes": true,
      "notes": "Added content-type sniffing and richer blocked/needs_render diagnostics.",
      "history": {
        "sessions": [
          {
            "session": 3,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Implemented http fetch + cache (TTL/size) with basic blocked/JS-only heuristics"
          },
          {
            "session": 13,
            "date": "2026-01-12",
            "action": "completed",
            "summary": "Added content-type sniffing, actionable blocked/needs_render diagnostics, and fetch-specific tests"
          }
        ],
        "files": [
          "src/wstk/fetch/http.py",
          "src/wstk/cache.py",
          "docs/spec.md",
          "tests/test_fetch_http.py"
        ],
        "decisions": []
      }
    },
    {
      "id": "extract-001",
      "name": "Content extraction outputs",
      "description": "Extraction supports default readable output and optional structured doc mode",
      "steps": [
        "Reader-mode extraction to Markdown/plain text",
        "Optional doc-mode extraction (headings/sections/links)",
        "Provenance metadata included (URL, timestamp, fetch method)",
        "Reasonable truncation strategy with `--max-tokens`/`--max-chars`"
      ],
      "passes": true,
      "notes": "Added docs extractor output, provenance for file inputs, and max-token truncation.",
      "history": {
        "sessions": [
          {
            "session": 3,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Implemented readability-based extraction to markdown/text and wired into `wstk extract`"
          },
          {
            "session": 14,
            "date": "2026-01-12",
            "action": "completed",
            "summary": "Implemented docs-mode extraction with sections/links, added provenance for file inputs, and added max-token truncation + tests"
          }
        ],
        "files": [
          "docs/spec.md",
          "src/wstk/commands/extract_cmd.py",
          "src/wstk/extract/docs_extractor.py",
          "src/wstk/extract/readability_extractor.py",
          "src/wstk/models.py",
          "tests/test_extract_docs.py"
        ],
        "decisions": []
      }
    },
    {
      "id": "safety-001",
      "name": "Safety controls (redaction + injection hardening)",
      "description": "Tool outputs include safety signals and redaction options to reduce risk",
      "steps": [
        "Warn on likely prompt injection / suspicious page patterns",
        "`--redact` supports removing obvious secrets and tokens from outputs",
        "Policy modes gate high-privilege fetch methods",
        "Logs avoid storing credentials/cookies by default"
      ],
      "passes": true,
      "notes": "Added prompt-injection warnings and redaction across outputs.",
      "history": {
        "sessions": [
          {
            "session": 15,
            "date": "2026-01-12",
            "action": "completed",
            "summary": "Added prompt-injection warnings, redaction helpers, and output sanitization across extract/search/fetch."
          }
        ],
        "files": [
          "docs/spec.md",
          "src/wstk/cli.py",
          "src/wstk/cli_support.py",
          "src/wstk/commands/extract_cmd.py",
          "src/wstk/commands/fetch_cmd.py",
          "src/wstk/commands/search_cmd.py",
          "src/wstk/safety.py",
          "src/wstk/urlutil.py",
          "tests/test_extract_docs.py",
          "tests/test_urlutil.py"
        ],
        "decisions": []
      }
    },
    {
      "id": "wrappers-001",
      "name": "Agent wrappers (skills)",
      "description": "Thin wrapper skills exist for common agent runtimes with progressive disclosure",
      "steps": [
        "Codex/Cursor/Droid-style `SKILL.md` teaches when to use search vs fetch vs render vs extract",
        "Claude Code wrapper (or docs) exists with the same contract",
        "Wrappers default to `wstk ... --json` and surface concise diagnostics to the agent",
        "Advanced flags documented in `references/` (403/JS-only troubleshooting, provider notes)"
      ],
      "passes": true,
      "notes": "Added troubleshooting/provider references, Claude Code wrapper notes, and clarified SKILL defaults.",
      "history": {
        "sessions": [
          {
            "session": 11,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Added SKILL.md with setup, commands, patterns, output formats, exit codes, and when-to-use guidance"
          },
          {
            "session": 16,
            "date": "2026-01-12",
            "action": "completed",
            "summary": "Added troubleshooting/provider references, Claude Code wrapper docs, and clarified SKILL agent defaults"
          }
        ],
        "files": [
          "SKILL.md",
          "README.md",
          "docs/claude-code.md",
          "references/providers.md",
          "references/troubleshooting.md"
        ],
        "decisions": []
      }
    },
    {
      "id": "eval-001",
      "name": "Evaluation harness (quality tracking)",
      "description": "A small eval harness can compare provider success and extraction quality over time",
      "steps": [
        "Suite format defined (queries + expected domains/URLs + optional gold snippets)",
        "`wstk eval --suite <file>` runs deterministically with caching controls",
        "Report includes success/blocked rates and basic extraction heuristics",
        "Supports adding new suites without code changes"
      ],
      "passes": true,
      "notes": "Added fetch/extract metrics and extraction heuristics to eval reporting.",
      "history": {
        "sessions": [
          {
            "session": 6,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Implemented `wstk eval` (search-only), suite parsing (JSON/JSONL), scoring (hit@k/MRR/overlap), and contract/unit tests with a sample suite"
          },
          {
            "session": 9,
            "date": "2026-01-06",
            "action": "progressed",
            "summary": "Extracted search-eval runner into a reusable module and simplified the eval command implementation"
          },
          {
            "session": 17,
            "date": "2026-01-12",
            "action": "completed",
            "summary": "Added fetch/extract metrics, eval summaries, and refreshed docs/tests."
          }
        ],
        "files": [
          "README.md",
          "docs/spec.md",
          "docs/test-plan.md",
          "src/wstk/cli.py",
          "src/wstk/commands/eval_cmd.py",
          "src/wstk/eval/*",
          "suites/search-basic.jsonl",
          "tests/test_cli_eval_contract.py",
          "tests/test_eval_scoring.py",
          "tests/test_eval_suite.py"
        ],
        "decisions": [
          {
            "session": 6,
            "decision": "Eval defaults to `--fail-on error` and uses domain-level expectations by default (URL expectations are optional and stricter)"
          }
        ]
      }
    },
    {
      "id": "render-001",
      "name": "Browser rendering (local)",
      "description": "JS rendering is available as an explicit escalation path via a local browser engine",
      "steps": [
        "`wstk render <url>` produces a Document with final DOM snapshot (and optional screenshot)",
        "`wstk extract --method browser <url>` uses render output when HTTP fetch is insufficient",
        "Profile/session reuse is explicit and gated (`--profile` / `--use-system-profile`)",
        "Headful/headless behaviors are explicit and respect `--no-input`",
        "Clear error modes: `needs_render` vs `blocked` vs `timeout`"
      ],
      "passes": true,
      "notes": "Implemented Playwright-backed render command and browser extraction path.",
      "history": {
        "sessions": [
          {
            "session": 18,
            "date": "2026-01-13",
            "action": "completed",
            "summary": "Added Playwright-based render command, browser extraction fallback, and tests/docs."
          }
        ],
        "files": [
          "README.md",
          "SKILL.md",
          "docs/spec.md",
          "docs/test-plan.md",
          "references/troubleshooting.md",
          "src/wstk/cli.py",
          "src/wstk/commands/extract_cmd.py",
          "src/wstk/commands/providers_cmd.py",
          "src/wstk/commands/render_cmd.py",
          "src/wstk/models.py",
          "src/wstk/render/__init__.py",
          "src/wstk/render/browser.py",
          "tests/test_cli_render_contract.py"
        ],
        "decisions": []
      }
    },
    {
      "id": "pipeline-001",
      "name": "One-shot pipeline helper",
      "description": "Agents can do a bounded search → extract flow with explicit selection and budgets",
      "steps": [
        "`wstk pipeline <query>` returns search results plus extracted document(s)",
        "`--plan` mode returns candidates without fetching",
        "Bounded by `--top-k`/`--extract-k` and timeouts",
        "In `standard` policy, does not auto-escalate to browser rendering"
      ],
      "passes": true,
      "notes": "Implemented pipeline command with plan mode, domain preference, and extraction.",
      "history": {
        "sessions": [
          {
            "session": 19,
            "date": "2026-01-13",
            "action": "completed",
            "summary": "Implemented pipeline command (search → extract) with plan mode, domain preference, and contract tests."
          }
        ],
        "files": [
          "README.md",
          "SKILL.md",
          "docs/spec.md",
          "src/wstk/cli.py",
          "src/wstk/commands/pipeline_cmd.py",
          "tests/test_cli_pipeline_contract.py",
          ".long-task-harness/features.json",
          ".long-task-harness/long-task-progress.md"
        ],
        "decisions": []
      }
    }
  ]
}
